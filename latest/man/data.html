<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Add measurement data · GeneralizedMetropolisHastings.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.5.0/styles/default.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Ubuntu+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../../versions.js"></script></head><body><nav class="toc"><h1>GeneralizedMetropolisHastings.jl</h1><form class="search" action="../search.html"><select id="version-selector" onChange="window.location.href=this.value"><option value="#" selected="selected" disabled="disabled">Version</option></select><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../index.html">Home</a></li><li><span class="toctext">Manual</span><ul><li><a class="toctext" href="guide.html">Guide</a></li><li><a class="toctext" href="folderstructure.html">Set up a folder structure</a></li><li class="current"><a class="toctext" href="data.html">Add measurement data</a><ul class="internal"><li><a class="toctext" href="#Creating-measurement-data-1">Creating measurement data</a></li><li><a class="toctext" href="#Storing-data-inside-the-package-1">Storing data inside the package</a></li><li><a class="toctext" href="#Using-AbstractData-objects-1">Using <code>AbstractData</code> objects</a></li><li><a class="toctext" href="#Extend-the-AbstractData-subtype-1">Extend the <code>AbstractData</code> subtype</a></li></ul></li><li><a class="toctext" href="noise.html">Specify measurement noise</a></li><li><a class="toctext" href="models.html">Specify model functions</a></li></ul></li><li><span class="toctext">Library</span><ul><li><a class="toctext" href="../lib/public.html">Public</a></li><li><a class="toctext" href="../lib/internal.html">Internal</a></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Manual</li><li><a href="data.html">Add measurement data</a></li></ul><a class="edit-page" href="https://github.com/QuantifyingUncertainty/GeneralizedMetropolisHastings.jl/tree/7fabf351c7132a6757c79421e1ab6ed7740e97bc/docs/src/man/data.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/></header><h1><a class="nav-anchor" id="Add-measurement-data-1" href="#Add-measurement-data-1">Add measurement data</a></h1><h2><a class="nav-anchor" id="Creating-measurement-data-1" href="#Creating-measurement-data-1">Creating measurement data</a></h2><p>The GMH package requires measurement data to be wrapped in an <a href="../lib/public.html#GeneralizedMetropolisHastings.AbstractData"><code>AbstractData</code></a> object.</p><p>Two <a href="../lib/public.html#GeneralizedMetropolisHastings.AbstractData"><code>AbstractData</code></a> subtypes are available. These are likely to cover most if not all requirements for specifying measurement data. The first is useful for predefined datasets, the second if data is generated by a function. This may be the model function itself or a different data generating function.</p><p>Create objects of these subtypes with the <a href="../lib/public.html#GeneralizedMetropolisHastings.data"><code>data</code></a> factory function.</p><h3><a class="nav-anchor" id="Predefined-datasets-1" href="#Predefined-datasets-1">Predefined datasets</a></h3><p>Create a data object wrapping an array with the <code>data(:array,...)</code> method. The wrapped array <code>values</code> should have 1 row per data point and 1 column per variable. Vector <code>index</code> contains an index value for each data point.</p><pre><code class="language-julia">julia&gt; using GeneralizedMetropolisHastings

julia&gt; index = 0:10;

julia&gt; values = 0:0.5:5.0;

julia&gt; d = data(:array,index,values)
DataArray with 1 variable and 11 values
 index: [0,1,2,3,4,5,6,7,8,9,10]
 values: 0.0:0.5:5.0</code></pre><h3><a class="nav-anchor" id="Data-generating-functions-1" href="#Data-generating-functions-1">Data generating functions</a></h3><p>Create a data object wrapping a function with <code>data(:function!,...)</code> or <code>data(:function,...)</code>.</p><p>The first variant requires a function which creates data values in a preallocated vector <code>out</code>, taking it as its first argument. In the example below, <code>t</code> is a time index for each data point, and the last argument of the <code>data</code> function is the <code>x</code> argument of data function <code>sin!</code>.</p><pre><code class="language-julia">julia&gt; using GeneralizedMetropolisHastings

julia&gt; sin!(r::Vector,x::AbstractVector) = (for i=1:length(x) r[i] = sin(x[i]) end ; r)
sin! (generic function with 1 method)

julia&gt; t = 0.0:0.1:1.0;

julia&gt; out = zeros(t);

julia&gt; d = data(:function!,t,out,sin!,2π*t)
DataFunction with 1 variable and 11 values
 index: [0.0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0]
 values: [0.0,0.587785,0.951057,0.951057,0.587785,1.22465e-16,-0.587785,-0.951057,-0.951057,-0.587785,-2.44929e-16]</code></pre><p>The second variant requires a data generating function returning a array with 1 row per data point and 1 column per variable. <code>t</code> is a time index for each data point. In the example below, the final 3 arguments of the <code>data</code> function are the arguments of the <code>sincos</code> function.</p><pre><code class="language-julia">julia&gt; using GeneralizedMetropolisHastings

julia&gt; sincos(x::AbstractVector,a::Real,b::Real) =  cat(2,sin(a*x),cos(b*x));

julia&gt; t = 0.0:0.1:1.0;

julia&gt; d = data(:function,t,sincos,2π*t,2.0,3.0)
DataFunction with 2 variables and 11 values
 index: [0.0,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,1.0]
 values: [0.0 1.0; 0.951057 -0.309017; … ; -0.951057 -0.309017; -4.89859e-16 1.0]</code></pre><h2><a class="nav-anchor" id="Storing-data-inside-the-package-1" href="#Storing-data-inside-the-package-1">Storing data inside the package</a></h2><p>Keep predefined data sets in the <code>data/</code> subfolder, as explained in <a href="folderstructure.html#Set-up-a-folder-structure-1">Set up a folder structure</a>.</p><h3><a class="nav-anchor" id="Small-data-sets-1" href="#Small-data-sets-1">Small data sets</a></h3><p>Small data sets can be stored as an array in a <code>.jl</code> file, wrapped in a function returning an (index,values) tuple.</p><pre><code class="language-julia">function mysmalldataset()
    index = 0:10;
    values = cat(2,0:0.5:5.0,10.0:1.0:20.0); #an 11x2 data array
    return index,values
end</code></pre><p>The data wrapping function can then be used to create an <code>:array</code> data object:</p><pre><code class="language-julia">julia&gt; include(&quot;mysmalldataset.jl&quot;)
julia&gt; d = data(:array,mysmalldataset()...) #... extracts the returned (index,value) Tuple</code></pre><h3><a class="nav-anchor" id="Large-data-sets-1" href="#Large-data-sets-1">Large data sets</a></h3><p>For larger data sets, it is recommended to store them in data format files such as <code>.jld</code> or <code>.mat</code>.</p><p>For more information see the <code>julia</code> packages <a href="https://github.com/JuliaIO/JLD.jl">JLD</a> and <a href="https://github.com/simonster/MAT.jl">MAT</a>.</p><p>Write data functions that load and extract the data from the data files. Some examples are provided <a href="https://github.com/QuantifyingUncertainty/GMHPhotoReceptor.jl/blob/master/models/datafunctions.jl">here</a>.</p><h2><a class="nav-anchor" id="Using-AbstractData-objects-1" href="#Using-AbstractData-objects-1">Using <code>AbstractData</code> objects</a></h2><ul><li><p>Retrieve stored data values with <a href="../lib/public.html#GeneralizedMetropolisHastings.datavalues-Tuple{GeneralizedMetropolisHastings.AbstractData}"><code>datavalues</code></a></p></li><li><p>Retrieve the index values with <a href="../lib/public.html#GeneralizedMetropolisHastings.dataindex-Tuple{GeneralizedMetropolisHastings.AbstractData}"><code>dataindex</code></a></p></li><li><p>Get the number of variables and values with <a href="../lib/public.html#GeneralizedMetropolisHastings.numvars-Tuple{GeneralizedMetropolisHastings.AbstractData}"><code>numvars</code></a> and <a href="../lib/public.html#GeneralizedMetropolisHastings.numvalues-Tuple{GeneralizedMetropolisHastings.AbstractData}"><code>numvalues</code></a></p></li><li><p>Generate a new set of values with internal function <a href="../lib/internal.html#GeneralizedMetropolisHastings.generate!-Tuple{GeneralizedMetropolisHastings.AbstractData}"><code>generate!</code></a></p></li></ul><pre><code class="language-">using PyPlot
using GeneralizedMetropolisHastings

#define the data object
t = -1.0:0.05:1.0;
d = data(:function,t,sin,2π*t);

#generate a new set of data values
GeneralizedMetropolisHastings.generate!(d);

#retrieve data index and values and plot
plot(dataindex(d),datavalues(d))
title(&quot;Data with $(numvars(d)) variable and $(numvalues(d)) values&quot;)
xlabel(&quot;Time&quot;)
ylabel(&quot;Values&quot;)
xlim(-1.0,1.0)

savefig(&quot;dataplot.svg&quot;)</code></pre><p><img src="dataplot.svg" alt/></p><h2><a class="nav-anchor" id="Extend-the-AbstractData-subtype-1" href="#Extend-the-AbstractData-subtype-1">Extend the <code>AbstractData</code> subtype</a></h2><p>It is possible to define your own data type by extending <a href="../lib/public.html#GeneralizedMetropolisHastings.AbstractData"><code>AbstractData</code></a>.</p><ul><li><p>Import <a href="../lib/public.html#GeneralizedMetropolisHastings.AbstractData"><code>AbstractData</code></a> and <a href="../lib/public.html#GeneralizedMetropolisHastings.data"><code>data</code></a> into your package module file</p></li><li><p>Define a subtype of <a href="../lib/public.html#GeneralizedMetropolisHastings.AbstractData"><code>AbstractData</code></a></p></li><li><p>Pick a unique symbol (e.g. <code>:mydata</code>) for your datatype and define a factory method <a href="../lib/public.html#GeneralizedMetropolisHastings.data"><code>data</code></a></p></li></ul><pre><code class="language-julia">immutable MyDataType &lt;: AbstractData
    field1
    field2
end

function data(::Type{Val{:mydata}},arg1,arg2,arg3,arg4)
    #steps to defined field1 and field2 out of arg1 to arg4
    ...
    MyDataType(field1,field2) #call the constructor of MyDataType
end</code></pre><p>With that in place, create objects of <code>MyDataType</code> as follows:</p><pre><code class="language-julia">d = data(:mydata,arg1,arg2,arg3,arg4)</code></pre><p>Import and implement methods for all functions listed in <a href="../lib/public.html#Data-Public-Functions-1">Data - Public Functions</a> and <a href="../lib/internal.html#Data-Internal-Functions-1">Data - Internal Functions</a></p><footer><hr/><a class="previous" href="folderstructure.html"><span class="direction">Previous</span><span class="title">Set up a folder structure</span></a><a class="next" href="noise.html"><span class="direction">Next</span><span class="title">Specify measurement noise</span></a></footer></article></body></html>
